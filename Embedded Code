#include <tm4c123gh6pm.h>
void RGBLED_Init (char led){
SYSCTL_RCGCGPIO_R |= 0x20;
while((SYSCTL_PRGPIO_R&0x20)==0){};
GPIO_PORTF_LOCK_R=0x4C4F434B;
GPIO_PORTF_CR_R|=led;
GPIO_PORTF_DIR_R |=led;
GPIO_PORTF_DEN_R |= led;
GPIO_PORTF_AMSEL_R &=~led;
GPIO_PORTF_PCTL_R &= ~0x0000FFF0;
GPIO_PORTF_DATA_R |=led;
}
void lcd_init(void)
{
SYSCTL_RCGCGPIO_R |= 0x0A; //activate port B and D 00001010
while((SYSCTL_PRGPIO_R&0x0A)==0){};
GPIO_PORTB_CR_R=0xFF;
GPIO_PORTB_DIR_R=0xFF;
GPIO_PORTB_AFSEL_R=0x00;
GPIO_PORTB_PCTL_R=0x0000000;
GPIO_PORTB_DEN_R=0xFF;
GPIO_PORTB_AMSEL_R=0x00;
GPIO_PORTB_PUR_R=0xFF;
GPIO_PORTB_DATA_R=0x00;
//PORD D initialize
GPIO_PORTD_LOCK_R= 0x4C4F434B;
GPIO_PORTD_CR_R|=0x07;
GPIO_PORTD_DIR_R|=0x07;
GPIO_PORTD_AFSEL_R &=~0x07;
GPIO_PORTD_PCTL_R &=~0x0000FFF;
GPIO_PORTD_DEN_R|=0x07;
GPIO_PORTD_AMSEL_R &=~0x07;
GPIO_PORTD_PUR_R &=~0x07;
GPIO_PORTD_DATA_R &=~0x07;
}
void delay_func(void)
{
  for(int i=1;i<20 ; i++)
  {
  i=i+0;
  }
  }
void lcd_command(char command){
GPIO_PORTD_DATA_R &=~0x06 ;// clear RS & RW 00000110
GPIO_PORTD_DATA_R |=0x01 ; // set enable =1
GPIO_PORTB_DATA_R =command ;// to send the value of command (clear,wake up ,display on )
delayMicroseconds(45);
GPIO_PORTD_DATA_R &=~0x01 ; // to change latch (covert enable from 1 to 0 vice versa)
}

void lcd_DATA(char DATA){
GPIO_PORTA_DATA_R &=~0x08 ; // RS = 1, R/W = 0
GPIO_PORTA_DATA_R |=0x40 ; // pulse E
GPIO_PORTB_DATA_R =DATA ;
delay_us(0);
GPIO_PORTA_DATA_R =0x00 ;
delay_us(40);
	// to change latch (covert enable from 1 to 0 vice versa)

}

void switch_init(void){
SYSCTL_RCGCGPIO_R |= 0x20;
while((SYSCTL_PRGPIO_R&0x20)==0){};
GPIO_PORTF_LOCK_R=0x4C4F434B;
GPIO_PORTF_CR_R|=0x01;
GPIO_PORTF_DIR_R &=~ 0x01;
GPIO_PORTF_DEN_R |= 0x01;
GPIO_PORTF_AMSEL_R &=~0x01;
GPIO_PORTF_PCTL_R &=~0x0000000F;
GPIO_PORTF_PUR_R |= 0x01;
}
/*
void clear1(void) {
GPIO_PORTD_DATA_R &=~0x06 ;// clear RS & RW 00000110
GPIO_PORTD_DATA_R |=0x01 ; // set enable =1111
GPIO_PORTB_DATA_R =0x01 ;// to send the value of command (clear,wake up ,display on )
delay_func();
GPIO_PORTD_DATA_R &=~0x01 ; // to change latch (covert enable from 1 to 0 vice versa)
}
void Return(void)  {
GPIO_PORTD_DATA_R &=~0x06 ;// clear RS & RW 00000110
GPIO_PORTD_DATA_R |=0x01 ; // set enable =1
GPIO_PORTB_DATA_R =0x02 ;// to send the value of command (clear,wake up ,display on )
delay_func();
GPIO_PORTD_DATA_R &=~0x01 ; // to change latch (covert enable from 1 to 0 vice versa)home
}
void D0_to_D7(void) {
GPIO_PORTD_DATA_R &=~0x06 ;// clear RS & RW 00000110
GPIO_PORTD_DATA_R |=0x01 ; // set enable =1
GPIO_PORTB_DATA_R =0x38 ;// to send the value of command (clear,wake up ,display on )
delay_func();
GPIO_PORTD_DATA_R &=~0x01 ; // to change latch (covert enable from 1 to 0 vice versa)
}
void wakeup1(void) {
GPIO_PORTD_DATA_R &=~0x06 ; // clear RS & RW 00000110
GPIO_PORTD_DATA_R |=0x01 ; // set enable =1
GPIO_PORTB_DATA_R =0x30 ;// to send the value of command (clear,wake up ,display on )
delay_func();
GPIO_PORTD_DATA_R &=~0x01 ; // to change latch (covert enable from 1 to 0 vice versa)
}
void increment_curso (void) {
GPIO_PORTD_DATA_R &=~0x06;// clear RS & RW 00000110
GPIO_PORTD_DATA_R |=0x01 ; // set enable =1
GPIO_PORTB_DATA_R =0x06 ;// to send the value of command (clear,wake up ,display on )
delay_func();
GPIO_PORTD_DATA_R &=~0x01 ; // to change latch (covert enable from 1 to 0 vice versa)
}
void Display_on (void){
GPIO_PORTD_DATA_R &=~0x06;// clear RS & RW 00000110
GPIO_PORTD_DATA_R |=0x01 ; // set enable =1
GPIO_PORTB_DATA_R =0x0f ;// to send the value of command (clear,wake up ,display on )
delay_func();
GPIO_PORTD_DATA_R &=~0x01 ; // to change latch (covert enable from 1 to 0 vice versa)
}*/

void setup() {}
  // put your setup code here, to run once:


void loop() {
  // put your main code here, to run repeatedly:
lcd_init();
RGBLED_Init(0x04);

lcd_command(0x30);
lcd_command(0x0F);
lcd_command(0x38);
lcd_command(0x01);
lcd_command(0x06);
lcd_DATA (0x0A);

/////////////////for the switch
}
if (GPIO_PORTF_DATA_R !=0x01 )   // if switch 0 is on
 { if ( distance > 100 )
     {GPIO_PORTF_DATA_R =0x08;
			 delay_ms(2000);
			 GPIO_PORTF_DATA_R &=~0x08;
		 }  // green led on
    else GPIO_PORTF_DATA_R &=~0x08;
	 }
else GPIO_PORTF_DATA_R &=~0x08;

}
